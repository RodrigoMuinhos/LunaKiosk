spring:
  application:
    name: lunapay
  datasource:
    # Banco via env (NUNCA commitar credenciais). Defaults apontam para dev local.
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/lunadb?currentSchema=luna}
    username: ${SPRING_DATASOURCE_USERNAME:postgres}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: false
        show_sql: false
        default_schema: luna
    show-sql: false


server:
  # Railway provides PORT; docker-compose commonly uses SERVER_PORT.
  port: ${PORT:${SERVER_PORT:8082}}

jwt:
  # Defina JWT_SECRET no ambiente. Este default é APENAS para dev local.
  secret: ${JWT_SECRET:dev-only-change-me}

logging:
  level:
    com.luna.pay: DEBUG
    org.springframework.web: DEBUG
    org.springframework.security: INFO

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized

payment:
  gateways:
    asaas:
      enabled: true
      environment: ${ASAAS_ENVIRONMENT:sandbox}
      # API Key dinâmica baseada no ambiente
      apiKey: ${ASAAS_SANDBOX_API_KEY:}
      walletId: ${ASAAS_SANDBOX_WALLET_ID:}
      baseUrl: https://sandbox.asaas.com/api/v3
      webhookSecret: ${ASAAS_WEBHOOK_SECRET:}
      timeoutSeconds: 30
    c6:
      enabled: ${C6_ENABLED:false}
      apiKey: ${C6_API_KEY:}
      apiSecret: ${C6_API_SECRET:}
      baseUrl: ${C6_BASE_URL:https://api.c6bank.com.br}
      webhookSecret: ${C6_WEBHOOK_SECRET:}
      timeoutSeconds: 30

---
# Production profile para Asaas
spring:
  config:
    activate:
      on-profile: production
  datasource:
    # Em producao, forneca URL/USER/PASS via variaveis do provider (Railway/Render/etc.)
    url: ${SPRING_DATASOURCE_URL:}
    username: ${SPRING_DATASOURCE_USERNAME:}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    driver-class-name: ${SPRING_DATASOURCE_DRIVER:org.postgresql.Driver}

payment:
  gateways:
    asaas:
      enabled: true
      environment: ${ASAAS_ENVIRONMENT:production}
      apiKey: ${ASAAS_PROD_API_KEY:}
      walletId: ${ASAAS_PROD_WALLET_ID:}
      baseUrl: https://api.asaas.com/v3
      webhookSecret: ${ASAAS_WEBHOOK_SECRET:}
